---
title: "Refugees"
format: dashboard
server: shiny
---


```{r}
#| context: setup
#| include: false

library(tidyverse)
library(refugees)
library(shiny)
library(ggplot2)
library(unhcrthemes)
```

# Exploratory Data
```{r}

```

# Demographics



# Asylum Application Acceptance Rates
```{r}
# Data Wrangling

#| context: server
#| include: false

countries_2 <-  countries %>% rename(coo_name = name)

approval <- reactive({asylum_decisions %>%
   mutate(approved=
         dec_recognized+dec_other) %>%
    filter(year=c("2013","2014","2015","2016","2017","2018","2019","2020","2021","2022"))
    left_join(countries_2, join_by(coo_name)) %>%
  group_by(year,input$unhcr_region)

  #  # filter(unhcr_region!="NA") %>%


})

output$data <- renderTable({approval})

output$plot <- renderPlot({
    p <- ggplot(approval,
       aes(x = year,
           y = approved,
           fill = approved)) +
        geom_col() +
        theme_unhcr()
})






```

## {.sidebar}
```{r}
checkboxGroupInput("unhcr_region", label=h3("Choose UNHCR Region"),
                   choices=list("Asia and the Pacific"="Asia and the Pacific", "Europe"="Europe", "Southern Africa"="Southern Africa", "The Americas"="The Americas","Middle East and North Africa"="Middle East and North Africa", "East and Horn of Africa"="East and Horn of Africa", "West and Central Africa"="West and Central Africa" ),
selected="Asia and the Pacific")


```



