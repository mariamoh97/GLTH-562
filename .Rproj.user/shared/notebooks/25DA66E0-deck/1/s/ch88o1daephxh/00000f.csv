"0",""
"0","# Data URL"
"0","df_url <- read_csv(""https://raw.githubusercontent.com/GDS-ODSSS/unhcr-dataviz-platform/master/data/geospatial/bubble_map.csv"")"
"2","[1mRows: [22m[34m95[39m [1mColumns: [22m[34m5[39m"
"2","[36mâ”€â”€[39m [1mColumn specification[22m [36mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[1mDelimiter:[22m "",""
[31mchr[39m (2): gis_name, iso3
[32mdbl[39m (3): lon, lat, ref"
"2","
[36mâ„¹[39m Use `spec()` to retrieve the full column specification for this data.
[36mâ„¹[39m Specify the column types or set `show_col_types = FALSE` to quiet this message."
"0","country_data <- refugees::population %>%"
"0","                filter(year >= 2012 & year <= 2022) %>%"
"0","                group_by(coo_name, coo_iso) %>%"
"0","                summarise(total_refugees = sum(refugees),"
"0","                          total_asylum = sum(asylum_seekers),"
"0","                          total_idps = sum(idps)) %>%"
"0","                ungroup()"
"2","`summarise()` has grouped output by 'coo_name'. You can override using the `.groups` argument."
"0","# country_data"
"0","loc_data <- country_data %>%"
"0","            left_join(df_url, c(""coo_iso"" = ""iso3"")) %>%"
"0","            select(-gis_name, -ref)"
"0",""
"0","top10_refugees <- loc_data %>%"
"0","                  arrange(desc(total_refugees)) %>%"
"0","                  drop_na(lon)"
"0","# print(head(top10_refugees, 10))"
"0",""
"0","top10_asylum <- loc_data %>% "
"0","                arrange(desc(total_asylum)) %>%"
"0","                drop_na(lon)"
"0","# print(head(top10_asylum, 10))"
"0",""
"0","top10_idps <- loc_data %>%"
"0","              arrange(desc(total_idps)) %>%"
"0","              drop_na(lon)"
"0","# print(head(top10_idps, 10))"
"0","            "
"0",""
"0","poly_url <- ""https://raw.githubusercontent.com/GDS-ODSSS/unhcr-dataviz-platform/master/data/geospatial/world_polygons_simplified.json"""
"0","line_url <- ""https://raw.githubusercontent.com/GDS-ODSSS/unhcr-dataviz-platform/master/data/geospatial/world_lines_simplified.json"""
"0",""
"0","# Read and transform data for refugees"
"0","df_ref <- top10_refugees %>% "
"0","  st_as_sf(coords = c(""lon"", ""lat""),"
"0","           crs = 4326)"
"0",""
"0","poly <- read_sf(poly_url) %>%"
"0","  st_set_crs(4326)"
"0",""
"0","line <- read_sf(line_url) %>%"
"0","  mutate("
"0","    type = as_factor(type) %>%"
"0","      fct_relevel(""solid"", ""dashed"", ""dotted"", ""dashed-dot"")"
"0","  ) %>%"
"0","  st_set_crs(4326)"
"0",""
"0","# Read and transform data for asylum seekers"
"0","df_asy <- top10_asylum %>% "
"0","  st_as_sf(coords = c(""lon"", ""lat""),"
"0","           crs = 4326)"
"0",""
"0","poly <- read_sf(poly_url) %>%"
"0","  st_set_crs(4326)"
"0",""
"0","line <- read_sf(line_url) %>%"
"0","  mutate("
"0","    type = as_factor(type) %>%"
"0","      fct_relevel(""solid"", ""dashed"", ""dotted"", ""dashed-dot"")"
"0","  ) %>%"
"0","  st_set_crs(4326)"
"0",""
"0","# Read and transform data for internally displaced persons"
"0","df_idp <- top10_idps %>% "
"0","  st_as_sf(coords = c(""lon"", ""lat""),"
"0","           crs = 4326)"
"0",""
"0","poly <- read_sf(poly_url) %>%"
"0","  st_set_crs(4326)"
"0",""
"0","line <- read_sf(line_url) %>%"
"0","  mutate("
"0","    type = as_factor(type) %>%"
"0","      fct_relevel(""solid"", ""dashed"", ""dotted"", ""dashed-dot"")"
"0","  ) %>%"
"0","  st_set_crs(4326)"
"0",""
